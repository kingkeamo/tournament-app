@using MudBlazor
@using TournamentApp.Shared

<MudDialog>
    <TitleContent>
        <MudText Typo="Typo.h6">Add Player to Tournament</MudText>
    </TitleContent>
    <DialogContent>
    @if (_players == null)
    {
        <MudProgressCircular Indeterminate="true" />
    }
    else if (!_players.Any())
    {
        <MudAlert Severity="Severity.Warning">No players available. Please create players first.</MudAlert>
    }
    else
    {
        <EditForm EditContext="@_editContext">
            <DataAnnotationsValidator />
            <MudSelect @bind-Value="_viewModel.PlayerId" 
                       Label="Select Player" 
                       Variant="Variant.Outlined" 
                       HelperText="Choose a player to add to this tournament"
                       Class="mb-4">
                @foreach (var player in _players)
                {
                    <MudSelectItem Value="@player.Id">@player.Name</MudSelectItem>
                }
            </MudSelect>
            <ValidationMessage For="@(() => _viewModel.PlayerId)" />
        </EditForm>
        <DialogActions>
            <MudButton ButtonType="ButtonType.Button" 
                       Variant="Variant.Text" 
                       Color="Color.Default" 
                       OnClick="Cancel">
                Cancel
            </MudButton>
            <MudButton ButtonType="ButtonType.Button" 
                       Variant="Variant.Filled" 
                       Color="Color.Primary" 
                       Disabled="@_isSaving"
                       OnClick="HandleSubmit"
                       StartIcon="@Icons.Material.Filled.PersonAdd">
                @if (_isSaving)
                {
                    <MudProgressCircular Class="ms-n1" Size="Size.Small" Indeterminate="true" />
                    <MudText Class="ms-2">Adding...</MudText>
                }
                else
                {
                    <MudText>Add Player</MudText>
                }
            </MudButton>
        </DialogActions>
    }
    </DialogContent>
</MudDialog>

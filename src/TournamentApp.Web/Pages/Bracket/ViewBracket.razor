@page "/tournaments/{TournamentId}/bracket"
@inherits ViewBracketBase

<PageTitle>Bracket: @(_tournamentName ?? "Loading...")</PageTitle>

@if (_errorMessage != null)
{
    <MudAlert Severity="Severity.Error" Class="mt-4">
        <MudText Typo="Typo.h6">Error Loading Bracket</MudText>
        <MudText>@_errorMessage</MudText>
    </MudAlert>
}
else if (_bracket == null)
{
    <MudProgressLinear Color="Color.Primary" Indeterminate="true" Class="my-3" />
}
else if (_bracket.Matches.Count == 0)
{
    <MudAlert Severity="Severity.Info" Class="mt-4">
        <MudText>No bracket generated yet. Generate a bracket to get started!</MudText>
    </MudAlert>
}
else
{
    <MudText Typo="Typo.h4" Class="mb-4">@_tournamentName - Bracket</MudText>

    @foreach (var round in _bracket.MatchesByRound.OrderBy(r => r.Key))
    {
        <MudText Typo="Typo.h6" Class="mt-4 mb-2">@GetRoundName(round.Key)</MudText>
        <MudGrid>
            @foreach (var match in round.Value)
            {
                <MudItem xs="12" sm="6" md="4">
                    <MatchCard Match="match" OnScoreUpdate="HandleScoreUpdate" />
                </MudItem>
            }
        </MudGrid>
    }
}





